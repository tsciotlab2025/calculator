let display = document.getElementById('display');

// Append normal symbols
function appendSymbol(symbol) {
    display.value += symbol;
}

// Append functions like sin, cos, sinh, etc.
function appendFunction(fn) {
    display.value += fn + '(';
}

function clearDisplay() {
    display.value = '';
}

function deleteLast() {
    display.value = display.value.slice(0, -1);
}

function calculateResult() {
    try {
        // Replace % with /100
        let expression = display.value.replace(/%/g, '/100');

        // Replace math functions with JS Math
        expression = expression.replace(/sin/g, 'Math.sin')
                               .replace(/cos/g, 'Math.cos')
                               .replace(/tan/g, 'Math.tan')
                               .replace(/log/g, 'Math.log')
                               .replace(/sinh/g, 'Math.sinh')
                               .replace(/cosh/g, 'Math.cosh')
                               .replace(/tanh/g, 'Math.tanh');

        // Evaluate
        display.value = eval(expression);
    } catch (e) {
        display.value = 'Error';
    }
}

function calculateSqrt() {
    try {
        display.value = Math.sqrt(eval(display.value));
    } catch (e) {
        display.value = 'Error';
    }
}

// Voice Recognition
const voiceBtn = document.getElementById('voice-btn');

if ('webkitSpeechRecognition' in window) {
    const recognition = new webkitSpeechRecognition();
    recognition.lang = 'en-US';
    recognition.continuous = false;
    recognition.interimResults = false;

    voiceBtn.addEventListener('click', () => {
        recognition.start();
    });

    recognition.onresult = function(event) {
        let voiceInput = event.results[0][0].transcript;

        // Convert spoken words to symbols
        voiceInput = voiceInput.replace(/plus/gi, '+')
                               .replace(/minus/gi, '-')
                               .replace(/times|multiply/gi, '*')
                               .replace(/divide/gi, '/')
                               .replace(/percent/gi, '%')
                               .replace(/square root/gi, 'Math.sqrt(')
                               .replace(/power/gi, '**')
                               .replace(/sine/gi, 'Math.sin(')
                               .replace(/cosine/gi, 'Math.cos(')
                               .replace(/tangent/gi, 'Math.tan(')
                               .replace(/sinh/gi, 'Math.sinh(')
                               .replace(/cosh/gi, 'Math.cosh(')
                               .replace(/tanh/gi, 'Math.tanh(')
                               .replace(/log/gi, 'Math.log(');

        display.value += voiceInput;
    };

    recognition.onerror = function(event) {
        alert('Voice recognition error: ' + event.error);
    };
} else {
    voiceBtn.disabled = true;
    voiceBtn.title = "Voice recognition not supported";
}
